# California Verbal Learning Test (CVLT) normative scoring functions

library(dplyr)

norm_cvlt <- function(df) {
  # Create default scaled score variables if they don't exist
  for (col in c("CVATOTSS", "CVLDFSS")) {
    if (!(col %in% names(df))) {
      df[[col]] <- NA_real_
    }
  }
  
  # Apply rounding to CVLT variables
  df <- df %>%
    mutate(
      CVATOT = round(CVATOT, 0),
      CVSDFR = round(CVSDFR, 0),
      CVLDFR = round(CVLDFR, 0)
    )
  
  df <- df %>%
    mutate(
      # Scaled scores for CVLT Total Score
      CVATOTSS = case_when(
        # Age 60-69
        AGE >= 60 & AGE < 70 & is.na(CVATOT) ~ NA_real_,
        AGE >= 60 & AGE < 70 & CVATOT == 0 ~ 7,
        AGE >= 60 & AGE < 70 & CVATOT == 1 ~ 8,
        AGE >= 60 & AGE < 70 & CVATOT == 2 ~ 9,
        AGE >= 60 & AGE < 70 & CVATOT == 3 ~ 10,
        AGE >= 60 & AGE < 70 & CVATOT == 4 ~ 11,
        AGE >= 60 & AGE < 70 & CVATOT == 5 ~ 12,
        AGE >= 60 & AGE < 70 & CVATOT == 6 ~ 13,
        AGE >= 60 & AGE < 70 & CVATOT == 7 ~ 14,
        AGE >= 60 & AGE < 70 & CVATOT == 8 ~ 15,
        AGE >= 60 & AGE < 70 & CVATOT == 9 ~ 16,
        AGE >= 60 & AGE < 70 & CVATOT == 10 ~ 17,
        AGE >= 60 & AGE < 70 & CVATOT == 11 ~ 18,
        AGE >= 60 & AGE < 70 & CVATOT == 12 ~ 19,
        AGE >= 60 & AGE < 70 & CVATOT == 13 ~ 20,
        AGE >= 60 & AGE < 70 & CVATOT == 14 ~ 21,
        AGE >= 60 & AGE < 70 & CVATOT == 15 ~ 23,
        AGE >= 60 & AGE < 70 & CVATOT == 16 ~ 24,
        AGE >= 60 & AGE < 70 & CVATOT == 17 ~ 25,
        AGE >= 60 & AGE < 70 & CVATOT == 18 ~ 26,
        AGE >= 60 & AGE < 70 & CVATOT == 19 ~ 27,
        AGE >= 60 & AGE < 70 & CVATOT == 20 ~ 28,
        AGE >= 60 & AGE < 70 & CVATOT == 21 ~ 29,
        AGE >= 60 & AGE < 70 & CVATOT == 22 ~ 30,
        AGE >= 60 & AGE < 70 & CVATOT == 23 ~ 31,
        AGE >= 60 & AGE < 70 & CVATOT == 24 ~ 32,
        AGE >= 60 & AGE < 70 & CVATOT == 25 ~ 33,
        AGE >= 60 & AGE < 70 & CVATOT == 26 ~ 34,
        AGE >= 60 & AGE < 70 & CVATOT == 27 ~ 35,
        AGE >= 60 & AGE < 70 & CVATOT == 28 ~ 36,
        AGE >= 60 & AGE < 70 & CVATOT == 29 ~ 37,
        AGE >= 60 & AGE < 70 & CVATOT == 30 ~ 38,
        AGE >= 60 & AGE < 70 & CVATOT == 31 ~ 39,
        AGE >= 60 & AGE < 70 & CVATOT == 32 ~ 40,
        AGE >= 60 & AGE < 70 & CVATOT == 33 ~ 41,
        AGE >= 60 & AGE < 70 & CVATOT == 34 ~ 42,
        AGE >= 60 & AGE < 70 & CVATOT == 35 ~ 43,
        AGE >= 60 & AGE < 70 & CVATOT == 36 ~ 45,
        AGE >= 60 & AGE < 70 & CVATOT == 37 ~ 46,
        AGE >= 60 & AGE < 70 & CVATOT == 38 ~ 47,
        AGE >= 60 & AGE < 70 & CVATOT == 39 ~ 48,
        AGE >= 60 & AGE < 70 & CVATOT == 40 ~ 49,
        AGE >= 60 & AGE < 70 & CVATOT == 41 ~ 50,
        AGE >= 60 & AGE < 70 & CVATOT == 42 ~ 51,
        AGE >= 60 & AGE < 70 & CVATOT == 43 ~ 52,
        AGE >= 60 & AGE < 70 & CVATOT == 44 ~ 53,
        AGE >= 60 & AGE < 70 & CVATOT == 45 ~ 55,
        AGE >= 60 & AGE < 70 & CVATOT == 46 ~ 56,
        AGE >= 60 & AGE < 70 & CVATOT == 47 ~ 57,
        AGE >= 60 & AGE < 70 & CVATOT == 48 ~ 59,
        AGE >= 60 & AGE < 70 & CVATOT == 49 ~ 60,
        AGE >= 60 & AGE < 70 & CVATOT == 50 ~ 62,
        AGE >= 60 & AGE < 70 & CVATOT == 51 ~ 63,
        AGE >= 60 & AGE < 70 & CVATOT == 52 ~ 64,
        AGE >= 60 & AGE < 70 & CVATOT == 53 ~ 65,
        AGE >= 60 & AGE < 70 & CVATOT == 54 ~ 66,
        AGE >= 60 & AGE < 70 & CVATOT == 55 ~ 67,
        AGE >= 60 & AGE < 70 & CVATOT == 56 ~ 68,
        AGE >= 60 & AGE < 70 & CVATOT == 57 ~ 69,
        AGE >= 60 & AGE < 70 & CVATOT == 58 ~ 70,
        AGE >= 60 & AGE < 70 & CVATOT == 59 ~ 71,
        AGE >= 60 & AGE < 70 & CVATOT == 60 ~ 72,
        AGE >= 60 & AGE < 70 & CVATOT == 61 ~ 73,
        AGE >= 60 & AGE < 70 & CVATOT == 62 ~ 74,
        AGE >= 60 & AGE < 70 & CVATOT == 63 ~ 75,
        AGE >= 60 & AGE < 70 & CVATOT == 64 ~ 76,
        AGE >= 60 & AGE < 70 & CVATOT == 65 ~ 77,
        AGE >= 60 & AGE < 70 & CVATOT == 66 ~ 78,
        AGE >= 60 & AGE < 70 & CVATOT == 67 ~ 79,
        AGE >= 60 & AGE < 70 & CVATOT == 68 ~ 80,
        AGE >= 60 & AGE < 70 & CVATOT == 69 ~ 81,
        AGE >= 60 & AGE < 70 & CVATOT == 70 ~ 82,
        AGE >= 60 & AGE < 70 & CVATOT == 71 ~ 83,
        AGE >= 60 & AGE < 70 & CVATOT == 72 ~ 84,
        AGE >= 60 & AGE < 70 & CVATOT == 73 ~ 85,
        AGE >= 60 & AGE < 70 & CVATOT == 74 ~ 86,
        AGE >= 60 & AGE < 70 & CVATOT == 75 ~ 87,
        AGE >= 60 & AGE < 70 & CVATOT == 76 ~ 88,
        AGE >= 60 & AGE < 70 & CVATOT == 77 ~ 89,
        AGE >= 60 & AGE < 70 & CVATOT == 78 ~ 89,
        AGE >= 60 & AGE < 70 & CVATOT == 79 ~ 90,
        AGE >= 60 & AGE < 70 & CVATOT == 80 ~ 90,
        
        # Age 70-79
        AGE >= 70 & AGE < 80 & is.na(CVATOT) ~ NA_real_,
        AGE >= 70 & AGE < 80 & CVATOT == 0 ~ 8,
        AGE >= 70 & AGE < 80 & CVATOT == 1 ~ 9,
        AGE >= 70 & AGE < 80 & CVATOT == 2 ~ 10,
        AGE >= 70 & AGE < 80 & CVATOT == 3 ~ 11,
        AGE >= 70 & AGE < 80 & CVATOT == 4 ~ 12,
        AGE >= 70 & AGE < 80 & CVATOT == 5 ~ 13,
        AGE >= 70 & AGE < 80 & CVATOT == 6 ~ 14,
        AGE >= 70 & AGE < 80 & CVATOT == 7 ~ 15,
        AGE >= 70 & AGE < 80 & CVATOT == 8 ~ 16,
        AGE >= 70 & AGE < 80 & CVATOT == 9 ~ 17,
        AGE >= 70 & AGE < 80 & CVATOT == 10 ~ 18,
        AGE >= 70 & AGE < 80 & CVATOT == 11 ~ 19,
        AGE >= 70 & AGE < 80 & CVATOT == 12 ~ 20,
        AGE >= 70 & AGE < 80 & CVATOT == 13 ~ 21,
        AGE >= 70 & AGE < 80 & CVATOT == 14 ~ 22,
        AGE >= 70 & AGE < 80 & CVATOT == 15 ~ 24,
        AGE >= 70 & AGE < 80 & CVATOT == 16 ~ 25,
        AGE >= 70 & AGE < 80 & CVATOT == 17 ~ 26,
        AGE >= 70 & AGE < 80 & CVATOT == 18 ~ 27,
        AGE >= 70 & AGE < 80 & CVATOT == 19 ~ 28,
        AGE >= 70 & AGE < 80 & CVATOT == 20 ~ 29,
        AGE >= 70 & AGE < 80 & CVATOT == 21 ~ 30,
        AGE >= 70 & AGE < 80 & CVATOT == 22 ~ 31,
        AGE >= 70 & AGE < 80 & CVATOT == 23 ~ 33,
        AGE >= 70 & AGE < 80 & CVATOT == 24 ~ 34,
        AGE >= 70 & AGE < 80 & CVATOT == 25 ~ 35,
        AGE >= 70 & AGE < 80 & CVATOT == 26 ~ 37,
        AGE >= 70 & AGE < 80 & CVATOT == 27 ~ 38,
        AGE >= 70 & AGE < 80 & CVATOT == 28 ~ 39,
        AGE >= 70 & AGE < 80 & CVATOT == 29 ~ 41,
        AGE >= 70 & AGE < 80 & CVATOT == 30 ~ 42,
        AGE >= 70 & AGE < 80 & CVATOT == 31 ~ 44,
        AGE >= 70 & AGE < 80 & CVATOT == 32 ~ 45,
        AGE >= 70 & AGE < 80 & CVATOT == 33 ~ 46,
        AGE >= 70 & AGE < 80 & CVATOT == 34 ~ 47,
        AGE >= 70 & AGE < 80 & CVATOT == 35 ~ 49,
        AGE >= 70 & AGE < 80 & CVATOT == 36 ~ 50,
        AGE >= 70 & AGE < 80 & CVATOT == 37 ~ 51,
        AGE >= 70 & AGE < 80 & CVATOT == 38 ~ 52,
        AGE >= 70 & AGE < 80 & CVATOT == 39 ~ 53,
        AGE >= 70 & AGE < 80 & CVATOT == 40 ~ 54,
        AGE >= 70 & AGE < 80 & CVATOT == 41 ~ 55,
        AGE >= 70 & AGE < 80 & CVATOT == 42 ~ 56,
        AGE >= 70 & AGE < 80 & CVATOT == 43 ~ 57,
        AGE >= 70 & AGE < 80 & CVATOT == 44 ~ 58,
        AGE >= 70 & AGE < 80 & CVATOT == 45 ~ 59,
        AGE >= 70 & AGE < 80 & CVATOT == 46 ~ 60,
        AGE >= 70 & AGE < 80 & CVATOT == 47 ~ 61,
        AGE >= 70 & AGE < 80 & CVATOT == 48 ~ 62,
        AGE >= 70 & AGE < 80 & CVATOT == 49 ~ 63,
        AGE >= 70 & AGE < 80 & CVATOT == 50 ~ 64,
        AGE >= 70 & AGE < 80 & CVATOT == 51 ~ 65,
        AGE >= 70 & AGE < 80 & CVATOT == 52 ~ 66,
        AGE >= 70 & AGE < 80 & CVATOT == 53 ~ 67,
        AGE >= 70 & AGE < 80 & CVATOT == 54 ~ 68,
        AGE >= 70 & AGE < 80 & CVATOT == 55 ~ 69,
        AGE >= 70 & AGE < 80 & CVATOT == 56 ~ 70,
        AGE >= 70 & AGE < 80 & CVATOT == 57 ~ 71,
        AGE >= 70 & AGE < 80 & CVATOT == 58 ~ 72,
        AGE >= 70 & AGE < 80 & CVATOT == 59 ~ 73,
        AGE >= 70 & AGE < 80 & CVATOT == 60 ~ 74,
        AGE >= 70 & AGE < 80 & CVATOT == 61 ~ 75,
        AGE >= 70 & AGE < 80 & CVATOT == 62 ~ 76,
        AGE >= 70 & AGE < 80 & CVATOT == 63 ~ 77,
        AGE >= 70 & AGE < 80 & CVATOT == 64 ~ 78,
        AGE >= 70 & AGE < 80 & CVATOT == 65 ~ 79,
        AGE >= 70 & AGE < 80 & CVATOT == 66 ~ 80,
        AGE >= 70 & AGE < 80 & CVATOT == 67 ~ 81,
        AGE >= 70 & AGE < 80 & CVATOT == 68 ~ 82,
        AGE >= 70 & AGE < 80 & CVATOT == 69 ~ 83,
        AGE >= 70 & AGE < 80 & CVATOT == 70 ~ 84,
        AGE >= 70 & AGE < 80 & CVATOT == 71 ~ 85,
        AGE >= 70 & AGE < 80 & CVATOT == 72 ~ 86,
        AGE >= 70 & AGE < 80 & CVATOT == 73 ~ 87,
        AGE >= 70 & AGE < 80 & CVATOT == 74 ~ 87,
        AGE >= 70 & AGE < 80 & CVATOT == 75 ~ 88,
        AGE >= 70 & AGE < 80 & CVATOT == 76 ~ 89,
        AGE >= 70 & AGE < 80 & CVATOT == 77 ~ 90,
        AGE >= 70 & AGE < 80 & CVATOT == 78 ~ 90,
        AGE >= 70 & AGE < 80 & CVATOT == 79 ~ 91,
        AGE >= 70 & AGE < 80 & CVATOT == 80 ~ 92,
        
        TRUE ~ as.numeric(CVATOTSS)  # Keep existing value if no match
      ),
      
     
      # Scaled scores for CVLT Long-Delay Free Recall
      CVLDFSS = case_when(
        # Age 60-69
        AGE >= 60 & AGE < 70 & is.na(CVLDFR) ~ NA_real_,
        AGE >= 60 & AGE < 70 & CVLDFR == 0 ~ -3.0,
        AGE >= 60 & AGE < 70 & CVLDFR == 1 ~ -2.5,
        AGE >= 60 & AGE < 70 & CVLDFR == 2 ~ -2.0,
        AGE >= 60 & AGE < 70 & CVLDFR == 3 ~ -2.0,
        AGE >= 60 & AGE < 70 & CVLDFR == 4 ~ -1.5,
        AGE >= 60 & AGE < 70 & CVLDFR == 5 ~ -1.0,
        AGE >= 60 & AGE < 70 & CVLDFR == 6 ~ -1.0,
        AGE >= 60 & AGE < 70 & CVLDFR == 7 ~ -0.5,
        AGE >= 60 & AGE < 70 & CVLDFR == 8 ~ 0.0,
        AGE >= 60 & AGE < 70 & CVLDFR == 9 ~ 0.0,
        AGE >= 60 & AGE < 70 & CVLDFR == 10 ~ 0.5,
        AGE >= 60 & AGE < 70 & CVLDFR == 11 ~ 1.0,
        AGE >= 60 & AGE < 70 & CVLDFR == 12 ~ 1.0,
        AGE >= 60 & AGE < 70 & CVLDFR == 13 ~ 1.5,
        AGE >= 60 & AGE < 70 & CVLDFR == 14 ~ 2.0,
        AGE >= 60 & AGE < 70 & CVLDFR == 15 ~ 2.0,
        AGE >= 60 & AGE < 70 & CVLDFR == 16 ~ 2.5,
        
        # Age 70-79
        AGE >= 70 & AGE < 80 & is.na(CVLDFR) ~ NA_real_,
        AGE >= 70 & AGE < 80 & CVLDFR == 0 ~ -2.5,
        AGE >= 70 & AGE < 80 & CVLDFR == 1 ~ -2.5,
        AGE >= 70 & AGE < 80 & CVLDFR == 2 ~ -2.0,
        AGE >= 70 & AGE < 80 & CVLDFR == 3 ~ -1.5,
        AGE >= 70 & AGE < 80 & CVLDFR == 4 ~ -1.5,
        AGE >= 70 & AGE < 80 & CVLDFR == 5 ~ -1.0,
        AGE >= 70 & AGE < 80 & CVLDFR == 6 ~ -0.5,
        AGE >= 70 & AGE < 80 & CVLDFR == 7 ~ 0.0,
        AGE >= 70 & AGE < 80 & CVLDFR == 8 ~ 0.0,
        AGE >= 70 & AGE < 80 & CVLDFR == 9 ~ 0.5,
        AGE >= 70 & AGE < 80 & CVLDFR == 10 ~ 1.0,
        AGE >= 70 & AGE < 80 & CVLDFR == 11 ~ 1.0,
        AGE >= 70 & AGE < 80 & CVLDFR == 12 ~ 1.5,
        AGE >= 70 & AGE < 80 & CVLDFR == 13 ~ 2.0,
        AGE >= 70 & AGE < 80 & CVLDFR == 14 ~ 2.0,
        AGE >= 70 & AGE < 80 & CVLDFR == 15 ~ 2.5,
        AGE >= 70 & AGE < 80 & CVLDFR == 16 ~ 3.0,
        
        TRUE ~ as.numeric(CVLDFSS)  # Keep existing value if no match
      )
    )
  
  return(df)
}
