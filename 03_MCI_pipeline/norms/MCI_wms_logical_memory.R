# WMS-3 Logical Memory normative scoring functions

library(dplyr)

norm_logical_memory <- function(df) {
  # Create default scaled score columns if they don't exist
  for (col in c("LM1ASS", "LM1BSS", "LM2ASS", "LM2BSS")) {
    if (!(col %in% names(df))) {
      df[[col]] <- NA_real_
    }
  }
  
  # Apply rounding to Logical Memory variables
  df <- df %>%
    mutate(
      LM1A = round(LM1A, 0),
      LM1B = round(LM1B, 0),
      LM2A = round(LM2A, 0),
      LM2B = round(LM2B, 0)
    )
  
  df <- df %>%
    mutate(
      # Story A Immediate Recall Scaled Score
      LM1ASS = case_when(
        # Check for missing values first
        is.na(LM1A) ~ NA_real_,
        
        # Age 45-54
        AGE >= 45 & AGE < 55 & LM1A == 0 ~ 1,
        AGE >= 45 & AGE < 55 & LM1A == 1 ~ 2,
        AGE >= 45 & AGE < 55 & LM1A >= 2 & LM1A <= 3 ~ 3,
        AGE >= 45 & AGE < 55 & LM1A == 4 ~ 4,
        AGE >= 45 & AGE < 55 & LM1A >= 5 & LM1A <= 6 ~ 5,
        AGE >= 45 & AGE < 55 & LM1A == 7 ~ 6,
        AGE >= 45 & AGE < 55 & LM1A >= 8 & LM1A <= 9 ~ 7,
        AGE >= 45 & AGE < 55 & LM1A >= 10 & LM1A <= 11 ~ 8,
        AGE >= 45 & AGE < 55 & LM1A == 12 ~ 9,
        AGE >= 45 & AGE < 55 & LM1A >= 13 & LM1A <= 14 ~ 10,
        AGE >= 45 & AGE < 55 & LM1A == 15 ~ 11,
        AGE >= 45 & AGE < 55 & LM1A >= 16 & LM1A <= 17 ~ 12,
        AGE >= 45 & AGE < 55 & LM1A == 18 ~ 13,
        AGE >= 45 & AGE < 55 & LM1A >= 19 & LM1A <= 20 ~ 14,
        AGE >= 45 & AGE < 55 & LM1A == 21 ~ 15,
        AGE >= 45 & AGE < 55 & LM1A == 22 ~ 16,
        AGE >= 45 & AGE < 55 & LM1A == 23 ~ 17,
        AGE >= 45 & AGE < 55 & LM1A == 24 ~ 18,
        AGE >= 45 & AGE < 55 & LM1A == 25 ~ 19,
        
        # Age 55-64
        AGE >= 55 & AGE < 65 & LM1A == 0 ~ 1,
        AGE >= 55 & AGE < 65 & LM1A == 1 ~ 2,
        AGE >= 55 & AGE < 65 & LM1A >= 2 & LM1A <= 3 ~ 3,
        AGE >= 55 & AGE < 65 & LM1A == 4 ~ 4,
        AGE >= 55 & AGE < 65 & LM1A >= 5 & LM1A <= 6 ~ 5,
        AGE >= 55 & AGE < 65 & LM1A == 7 ~ 6,
        AGE >= 55 & AGE < 65 & LM1A >= 8 & LM1A <= 9 ~ 7,
        AGE >= 55 & AGE < 65 & LM1A == 10 ~ 8,
        AGE >= 55 & AGE < 65 & LM1A >= 11 & LM1A <= 12 ~ 9,
        AGE >= 55 & AGE < 65 & LM1A == 13 ~ 10,
        AGE >= 55 & AGE < 65 & LM1A >= 14 & LM1A <= 15 ~ 11,
        AGE >= 55 & AGE < 65 & LM1A == 16 ~ 12,
        AGE >= 55 & AGE < 65 & LM1A >= 17 & LM1A <= 18 ~ 13,
        AGE >= 55 & AGE < 65 & LM1A >= 19 & LM1A <= 20 ~ 14,
        AGE >= 55 & AGE < 65 & LM1A == 21 ~ 15,
        AGE >= 55 & AGE < 65 & LM1A == 22 ~ 16,
        AGE >= 55 & AGE < 65 & LM1A == 23 ~ 17,
        AGE >= 55 & AGE < 65 & LM1A == 24 ~ 18,
        AGE >= 55 & AGE < 65 & LM1A == 25 ~ 19,
        
        # Age 65-69
        AGE >= 65 & AGE < 70 & LM1A == 0 ~ 1,
        AGE >= 65 & AGE < 70 & LM1A == 1 ~ 2,
        AGE >= 65 & AGE < 70 & LM1A == 2 ~ 3,
        AGE >= 65 & AGE < 70 & LM1A == 3 ~ 4,
        AGE >= 65 & AGE < 70 & LM1A >= 4 & LM1A <= 5 ~ 5,
        AGE >= 65 & AGE < 70 & LM1A == 6 ~ 6,
        AGE >= 65 & AGE < 70 & LM1A >= 7 & LM1A <= 8 ~ 7,
        AGE >= 65 & AGE < 70 & LM1A == 9 ~ 8,
        AGE >= 65 & AGE < 70 & LM1A >= 10 & LM1A <= 11 ~ 9,
        AGE >= 65 & AGE < 70 & LM1A == 12 ~ 10,
        AGE >= 65 & AGE < 70 & LM1A >= 13 & LM1A <= 14 ~ 11,
        AGE >= 65 & AGE < 70 & LM1A >= 15 & LM1A <= 16 ~ 12,
        AGE >= 65 & AGE < 70 & LM1A == 17 ~ 13,
        AGE >= 65 & AGE < 70 & LM1A >= 18 & LM1A <= 19 ~ 14,
        AGE >= 65 & AGE < 70 & LM1A == 20 ~ 15,
        AGE >= 65 & AGE < 70 & LM1A >= 21 & LM1A <= 22 ~ 16,
        AGE >= 65 & AGE < 70 & LM1A == 23 ~ 17,
        AGE >= 65 & AGE < 70 & LM1A == 24 ~ 18,
        AGE >= 65 & AGE < 70 & LM1A == 25 ~ 19,
        
        # Age 70-74
        AGE >= 70 & AGE < 75 & LM1A == 0 ~ 1,
        AGE >= 70 & AGE < 75 & LM1A == 1 ~ 2,
        AGE >= 70 & AGE < 75 & LM1A == 2 ~ 3,
        AGE >= 70 & AGE < 75 & LM1A == 3 ~ 4,
        AGE >= 70 & AGE < 75 & LM1A == 4 ~ 5,
        AGE >= 70 & AGE < 75 & LM1A == 5 ~ 6,
        AGE >= 70 & AGE < 75 & LM1A >= 6 & LM1A <= 7 ~ 7,
        AGE >= 70 & AGE < 75 & LM1A == 8 ~ 8,
        AGE >= 70 & AGE < 75 & LM1A >= 9 & LM1A <= 10 ~ 9,
        AGE >= 70 & AGE < 75 & LM1A == 11 ~ 10,
        AGE >= 70 & AGE < 75 & LM1A >= 12 & LM1A <= 13 ~ 11,
        AGE >= 70 & AGE < 75 & LM1A >= 14 & LM1A <= 15 ~ 12,
        AGE >= 70 & AGE < 75 & LM1A == 16 ~ 13,
        AGE >= 70 & AGE < 75 & LM1A >= 17 & LM1A <= 18 ~ 14,
        AGE >= 70 & AGE < 75 & LM1A == 19 ~ 15,
        AGE >= 70 & AGE < 75 & LM1A >= 20 & LM1A <= 21 ~ 16,
        AGE >= 70 & AGE < 75 & LM1A == 22 ~ 17,
        AGE >= 70 & AGE < 75 & LM1A == 23 ~ 18,
        AGE >= 70 & AGE < 75 & LM1A >= 24 & LM1A <= 25 ~ 19,
        
        # Age 75-79
        AGE >= 75 & AGE < 80 & LM1A == 0 ~ 2,
        AGE >= 75 & AGE < 80 & LM1A == 1 ~ 3,
        AGE >= 75 & AGE < 80 & LM1A == 2 ~ 4,
        AGE >= 75 & AGE < 80 & LM1A == 3 ~ 5,
        AGE >= 75 & AGE < 80 & LM1A == 4 ~ 6,
        AGE >= 75 & AGE < 80 & LM1A >= 5 & LM1A <= 6 ~ 7,
        AGE >= 75 & AGE < 80 & LM1A == 7 ~ 8,
        AGE >= 75 & AGE < 80 & LM1A >= 8 & LM1A <= 9 ~ 9,
        AGE >= 75 & AGE < 80 & LM1A == 10 ~ 10,
        AGE >= 75 & AGE < 80 & LM1A >= 11 & LM1A <= 12 ~ 11,
        AGE >= 75 & AGE < 80 & LM1A >= 13 & LM1A <= 14 ~ 12,
        AGE >= 75 & AGE < 80 & LM1A >= 15 & LM1A <= 16 ~ 13,
        AGE >= 75 & AGE < 80 & LM1A == 17 ~ 14,
        AGE >= 75 & AGE < 80 & LM1A == 18 ~ 15,
        AGE >= 75 & AGE < 80 & LM1A >= 19 & LM1A <= 20 ~ 16,
        AGE >= 75 & AGE < 80 & LM1A == 21 ~ 17,
        AGE >= 75 & AGE < 80 & LM1A == 22 ~ 18,
        AGE >= 75 & AGE < 80 & LM1A >= 23 & LM1A <= 25 ~ 19,
        
        # Age 80-84
        AGE >= 80 & AGE <= 84 & LM1A == 0 ~ 2,
        AGE >= 80 & AGE <= 84 & LM1A == 1 ~ 4,
        AGE >= 80 & AGE <= 84 & LM1A == 2 ~ 5,
        AGE >= 80 & AGE <= 84 & LM1A == 3 ~ 6,
        AGE >= 80 & AGE <= 84 & LM1A >= 4 & LM1A <= 5 ~ 7,
        AGE >= 80 & AGE <= 84 & LM1A == 6 ~ 8,
        AGE >= 80 & AGE <= 84 & LM1A >= 7 & LM1A <= 8 ~ 9,
        AGE >= 80 & AGE <= 84 & LM1A == 9 ~ 10,
        AGE >= 80 & AGE <= 84 & LM1A >= 10 & LM1A <= 11 ~ 11,
        AGE >= 80 & AGE <= 84 & LM1A >= 12 & LM1A <= 13 ~ 12,
        AGE >= 80 & AGE <= 84 & LM1A >= 14 & LM1A <= 15 ~ 13,
        AGE >= 80 & AGE <= 84 & LM1A == 16 ~ 14,
        AGE >= 80 & AGE <= 84 & LM1A >= 17 & LM1A <= 18 ~ 15,
        AGE >= 80 & AGE <= 84 & LM1A == 19 ~ 16,
        AGE >= 80 & AGE <= 84 & LM1A >= 20 & LM1A <= 21 ~ 17,
        AGE >= 80 & AGE <= 84 & LM1A == 22 ~ 18,
        AGE >= 80 & AGE <= 84 & LM1A >= 23 & LM1A <= 25 ~ 19,
        
        # Age 85-89
        AGE >= 85 & AGE < 90 & LM1A == 0 ~ 2,
        AGE >= 85 & AGE < 90 & LM1A == 1 ~ 4,
        AGE >= 85 & AGE < 90 & LM1A == 2 ~ 5,
        AGE >= 85 & AGE < 90 & LM1A == 3 ~ 6,
        AGE >= 85 & AGE < 90 & LM1A == 4 ~ 7,
        AGE >= 85 & AGE < 90 & LM1A == 5 ~ 8,
        AGE >= 85 & AGE < 90 & LM1A >= 6 & LM1A <= 7 ~ 9,
        AGE >= 85 & AGE < 90 & LM1A == 8 ~ 10,
        AGE >= 85 & AGE < 90 & LM1A >= 9 & LM1A <= 10 ~ 11,
        AGE >= 85 & AGE < 90 & LM1A >= 11 & LM1A <= 12 ~ 12,
        AGE >= 85 & AGE < 90 & LM1A >= 13 & LM1A <= 14 ~ 13,
        AGE >= 85 & AGE < 90 & LM1A >= 15 & LM1A <= 16 ~ 14,
        AGE >= 85 & AGE < 90 & LM1A == 17 ~ 15,
        AGE >= 85 & AGE < 90 & LM1A >= 18 & LM1A <= 19 ~ 16,
        AGE >= 85 & AGE < 90 & LM1A == 20 ~ 17,
        AGE >= 85 & AGE < 90 & LM1A == 21 ~ 18,
        AGE >= 85 & AGE < 90 & LM1A >= 22 & LM1A <= 25 ~ 19,
        
        TRUE ~ as.numeric(LM1ASS)  # Keep existing value if no match
      ),
      
      # Story B Immediate Recall Scaled Score
      LM1BSS = case_when(
        # Check for missing values first
        is.na(LM1B) ~ NA_real_,
        
        # Age 45-54
        AGE >= 45 & AGE < 55 & LM1B >= 0 & LM1B <= 1 ~ 1,
        AGE >= 45 & AGE < 55 & LM1B == 2 ~ 2,
        AGE >= 45 & AGE < 55 & LM1B == 3 ~ 3,
        AGE >= 45 & AGE < 55 & LM1B == 4 ~ 4,
        AGE >= 45 & AGE < 55 & LM1B >= 5 & LM1B <= 6 ~ 5,
        AGE >= 45 & AGE < 55 & LM1B == 7 ~ 6,
        AGE >= 45 & AGE < 55 & LM1B == 8 ~ 7,
        AGE >= 45 & AGE < 55 & LM1B == 9 ~ 8,
        AGE >= 45 & AGE < 55 & LM1B >= 10 & LM1B <= 11 ~ 9,
        AGE >= 45 & AGE < 55 & LM1B == 12 ~ 10,
        AGE >= 45 & AGE < 55 & LM1B == 13 ~ 11,
        AGE >= 45 & AGE < 55 & LM1B >= 14 & LM1B <= 15 ~ 12,
        AGE >= 45 & AGE < 55 & LM1B == 16 ~ 13,
        AGE >= 45 & AGE < 55 & LM1B == 17 ~ 14,
        AGE >= 45 & AGE < 55 & LM1B >= 18 & LM1B <= 19 ~ 15,
        AGE >= 45 & AGE < 55 & LM1B == 20 ~ 16,
        AGE >= 45 & AGE < 55 & LM1B >= 21 & LM1B <= 22 ~ 17,
        AGE >= 45 & AGE < 55 & LM1B == 23 ~ 18,
        AGE >= 45 & AGE < 55 & LM1B >= 24 & LM1B <= 25 ~ 19,
        
        # Age 55-64
        AGE >= 55 & AGE < 65 & LM1B >= 0 & LM1B <= 1 ~ 1,
        AGE >= 55 & AGE < 65 & LM1B == 2 ~ 2,
        AGE >= 55 & AGE < 65 & LM1B == 3 ~ 3,
        AGE >= 55 & AGE < 65 & LM1B == 4 ~ 4,
        AGE >= 55 & AGE < 65 & LM1B >= 5 & LM1B <= 6 ~ 5,
        AGE >= 55 & AGE < 65 & LM1B == 7 ~ 6,
        AGE >= 55 & AGE < 65 & LM1B == 8 ~ 7,
        AGE >= 55 & AGE < 65 & LM1B == 9 ~ 8,
        AGE >= 55 & AGE < 65 & LM1B >= 10 & LM1B <= 11 ~ 9,
        AGE >= 55 & AGE < 65 & LM1B == 12 ~ 10,
        AGE >= 55 & AGE < 65 & LM1B == 13 ~ 11,
        AGE >= 55 & AGE < 65 & LM1B >= 14 & LM1B <= 15 ~ 12,
        AGE >= 55 & AGE < 65 & LM1B == 16 ~ 13,
        AGE >= 55 & AGE < 65 & LM1B == 17 ~ 14,
        AGE >= 55 & AGE < 65 & LM1B == 18 ~ 15,
        AGE >= 55 & AGE < 65 & LM1B >= 19 & LM1B <= 20 ~ 16,
        AGE >= 55 & AGE < 65 & LM1B == 21 ~ 17,
        AGE >= 55 & AGE < 65 & LM1B == 22 ~ 18,
        AGE >= 55 & AGE < 65 & LM1B >= 23 & LM1B <= 25 ~ 19,
        
        # Age 65-69
        AGE >= 65 & AGE < 70 & LM1B >= 0 & LM1B <= 1 ~ 1,
        AGE >= 65 & AGE < 70 & LM1B == 2 ~ 2,
        AGE >= 65 & AGE < 70 & LM1B == 3 ~ 3,
        AGE >= 65 & AGE < 70 & LM1B == 4 ~ 4,
        AGE >= 65 & AGE < 70 & LM1B >= 5 & LM1B <= 6 ~ 5,
        AGE >= 65 & AGE < 70 & LM1B == 7 ~ 6,
        AGE >= 65 & AGE < 70 & LM1B == 8 ~ 7,
        AGE >= 65 & AGE < 70 & LM1B == 9 ~ 8,
        AGE >= 65 & AGE < 70 & LM1B >= 10 & LM1B <= 11 ~ 9,
        AGE >= 65 & AGE < 70 & LM1B == 12 ~ 10,
        AGE >= 65 & AGE < 70 & LM1B == 13 ~ 11,
        AGE >= 65 & AGE < 70 & LM1B >= 14 & LM1B <= 15 ~ 12,
        AGE >= 65 & AGE < 70 & LM1B == 16 ~ 13,
        AGE >= 65 & AGE < 70 & LM1B == 17 ~ 14,
        AGE >= 65 & AGE < 70 & LM1B == 18 ~ 15,
        AGE >= 65 & AGE < 70 & LM1B >= 19 & LM1B <= 20 ~ 16,
        AGE >= 65 & AGE < 70 & LM1B == 21 ~ 17,
        AGE >= 65 & AGE < 70 & LM1B == 22 ~ 18,
        AGE >= 65 & AGE < 70 & LM1B >= 23 & LM1B <= 25 ~ 19,
        
        # Age 70-74
        AGE >= 70 & AGE < 75 & LM1B >= 0 & LM1B <= 1 ~ 1,
        AGE >= 70 & AGE < 75 & LM1B == 2 ~ 2,
        AGE >= 70 & AGE < 75 & LM1B == 3 ~ 3,
        AGE >= 70 & AGE < 75 & LM1B == 4 ~ 4,
        AGE >= 70 & AGE < 75 & LM1B == 5 ~ 5,
        AGE >= 70 & AGE < 75 & LM1B == 6 ~ 6,
        AGE >= 70 & AGE < 75 & LM1B == 7 ~ 7,
        AGE >= 70 & AGE < 75 & LM1B >= 8 & LM1B <= 9 ~ 8,
        AGE >= 70 & AGE < 75 & LM1B == 10 ~ 9,
        AGE >= 70 & AGE < 75 & LM1B == 11 ~ 10,
        AGE >= 70 & AGE < 75 & LM1B >= 12 & LM1B <= 13 ~ 11,
        AGE >= 70 & AGE < 75 & LM1B == 14 ~ 12,
        AGE >= 70 & AGE < 75 & LM1B == 15 ~ 13,
        AGE >= 70 & AGE < 75 & LM1B == 16 ~ 14,
        AGE >= 70 & AGE < 75 & LM1B >= 17 & LM1B <= 18 ~ 15,
        AGE >= 70 & AGE < 75 & LM1B == 19 ~ 16,
        AGE >= 70 & AGE < 75 & LM1B == 20 ~ 17,
        AGE >= 70 & AGE < 75 & LM1B == 21 ~ 18,
        AGE >= 70 & AGE < 75 & LM1B >= 22 & LM1B <= 25 ~ 19,
        
        # Age 75-79
        AGE >= 75 & AGE < 80 & LM1B == 0 ~ 2,
        AGE >= 75 & AGE < 80 & LM1B == 1 ~ 3,
        AGE >= 75 & AGE < 80 & LM1B >= 2 & LM1B <= 3 ~ 4,
        AGE >= 75 & AGE < 80 & LM1B >= 4 & LM1B <= 5 ~ 5,
        AGE >= 75 & AGE < 80 & LM1B == 6 ~ 6,
        AGE >= 75 & AGE < 80 & LM1B == 7 ~ 7,
        AGE >= 75 & AGE < 80 & LM1B >= 8 & LM1B <= 9 ~ 8,
        AGE >= 75 & AGE < 80 & LM1B == 10 ~ 9,
        AGE >= 75 & AGE < 80 & LM1B == 11 ~ 10,
        AGE >= 75 & AGE < 80 & LM1B >= 12 & LM1B <= 13 ~ 11,
        AGE >= 75 & AGE < 80 & LM1B == 14 ~ 12,
        AGE >= 75 & AGE < 80 & LM1B == 15 ~ 13,
        AGE >= 75 & AGE < 80 & LM1B == 16 ~ 14,
        AGE >= 75 & AGE < 80 & LM1B == 17 ~ 15,
        AGE >= 75 & AGE < 80 & LM1B == 18 ~ 16,
        AGE >= 75 & AGE < 80 & LM1B == 19 ~ 17,
        AGE >= 75 & AGE < 80 & LM1B == 20 ~ 18,
        AGE >= 75 & AGE < 80 & LM1B >= 21 & LM1B <= 25 ~ 19,
        
        # Age 80-84
        AGE >= 80 & AGE <= 84 & LM1B == 0 ~ 2,
        AGE >= 80 & AGE <= 84 & LM1B == 1 ~ 4,
        AGE >= 80 & AGE <= 84 & LM1B >= 2 & LM1B <= 3 ~ 5,
        AGE >= 80 & AGE <= 84 & LM1B >= 4 & LM1B <= 5 ~ 6,
        AGE >= 80 & AGE <= 84 & LM1B == 6 ~ 7,
        AGE >= 80 & AGE <= 84 & LM1B == 7 ~ 8,
        AGE >= 80 & AGE <= 84 & LM1B >= 8 & LM1B <= 9 ~ 9,
        AGE >= 80 & AGE <= 84 & LM1B == 10 ~ 10,
        AGE >= 80 & AGE <= 84 & LM1B >= 11 & LM1B <= 12 ~ 11,
        AGE >= 80 & AGE <= 84 & LM1B >= 13 & LM1B <= 14 ~ 12,
        AGE >= 80 & AGE <= 84 & LM1B == 15 ~ 13,
        AGE >= 80 & AGE <= 84 & LM1B == 16 ~ 14,
        AGE >= 80 & AGE <= 84 & LM1B == 17 ~ 15,
        AGE >= 80 & AGE <= 84 & LM1B == 18 ~ 16,
        AGE >= 80 & AGE <= 84 & LM1B == 19 ~ 17,
        AGE >= 80 & AGE <= 84 & LM1B == 20 ~ 18,
        AGE >= 80 & AGE <= 84 & LM1B >= 21 & LM1B <= 25 ~ 19,
        
        # Age 85-89
        AGE >= 85 & AGE < 90 & LM1B == 0 ~ 2,
        AGE >= 85 & AGE < 90 & LM1B == 1 ~ 4,
        AGE >= 85 & AGE < 90 & LM1B == 2 ~ 5,
        AGE >= 85 & AGE < 90 & LM1B == 3 ~ 6,
        AGE >= 85 & AGE < 90 & LM1B == 4 ~ 7,
        AGE >= 85 & AGE < 90 & LM1B == 5 ~ 8,
        AGE >= 85 & AGE < 90 & LM1B >= 6 & LM1B <= 7 ~ 9,
        AGE >= 85 & AGE < 90 & LM1B == 8 ~ 10,
        AGE >= 85 & AGE < 90 & LM1B >= 9 & LM1B <= 10 ~ 11,
        AGE >= 85 & AGE < 90 & LM1B >= 11 & LM1B <= 12 ~ 12,
        AGE >= 85 & AGE < 90 & LM1B >= 13 & LM1B <= 14 ~ 13,
        AGE >= 85 & AGE < 90 & LM1B == 15 ~ 14,
        AGE >= 85 & AGE < 90 & LM1B == 16 ~ 15,
        AGE >= 85 & AGE < 90 & LM1B == 17 ~ 16,
        AGE >= 85 & AGE < 90 & LM1B == 18 ~ 17,
        AGE >= 85 & AGE < 90 & LM1B == 19 ~ 18,
        AGE >= 85 & AGE < 90 & LM1B >= 20 & LM1B <= 25 ~ 19,
        
        TRUE ~ as.numeric(LM1BSS)  # Keep existing value if no match
      ),
      
      # Story A Delayed Recall Scaled Score
      LM2ASS = case_when(
        # Check for missing values first
        is.na(LM2A) ~ NA_real_,
        
        # Age 45-54
        AGE >= 45 & AGE < 55 & LM2A == 0 ~ 1,
        AGE >= 45 & AGE < 55 & LM2A == 1 ~ 2,
        AGE >= 45 & AGE < 55 & LM2A == 2 ~ 3,
        AGE >= 45 & AGE < 55 & LM2A == 3 ~ 4,
        AGE >= 45 & AGE < 55 & LM2A == 4 ~ 5,
        AGE >= 45 & AGE < 55 & LM2A == 5 ~ 6,
        AGE >= 45 & AGE < 55 & LM2A >= 6 & LM2A <= 7 ~ 7,
        AGE >= 45 & AGE < 55 & LM2A == 8 ~ 8,
        AGE >= 45 & AGE < 55 & LM2A >= 9 & LM2A <= 10 ~ 9,
        AGE >= 45 & AGE < 55 & LM2A >= 11 & LM2A <= 12 ~ 10,
        AGE >= 45 & AGE < 55 & LM2A >= 13 & LM2A <= 14 ~ 11,
        AGE >= 45 & AGE < 55 & LM2A == 15 ~ 12,
        AGE >= 45 & AGE < 55 & LM2A >= 16 & LM2A <= 17 ~ 13,
        AGE >= 45 & AGE < 55 & LM2A == 18 ~ 14,
        AGE >= 45 & AGE < 55 & LM2A >= 19 & LM2A <= 20 ~ 15,
        AGE >= 45 & AGE < 55 & LM2A == 21 ~ 16,
        AGE >= 45 & AGE < 55 & LM2A == 22 ~ 17,
        AGE >= 45 & AGE < 55 & LM2A == 23 ~ 18,
        AGE >= 45 & AGE < 55 & LM2A >= 24 & LM2A <= 25 ~ 19,
        
        # Age 55-64
        AGE >= 55 & AGE < 65 & LM2A == 0 ~ 1,
        AGE >= 55 & AGE < 65 & LM2A == 1 ~ 2,
        AGE >= 55 & AGE < 65 & LM2A == 2 ~ 3,
        AGE >= 55 & AGE < 65 & LM2A == 3 ~ 4,
        AGE >= 55 & AGE < 65 & LM2A == 4 ~ 5,
        AGE >= 55 & AGE < 65 & LM2A == 5 ~ 6,
        AGE >= 55 & AGE < 65 & LM2A == 6 ~ 7,
        AGE >= 55 & AGE < 65 & LM2A == 7 ~ 8,
        AGE >= 55 & AGE < 65 & LM2A >= 8 & LM2A <= 9 ~ 9,
        AGE >= 55 & AGE < 65 & LM2A >= 10 & LM2A <= 11 ~ 10,
        AGE >= 55 & AGE < 65 & LM2A >= 12 & LM2A <= 13 ~ 11,
        AGE >= 55 & AGE < 65 & LM2A == 14 ~ 12,
        AGE >= 55 & AGE < 65 & LM2A >= 15 & LM2A <= 16 ~ 13,
        AGE >= 55 & AGE < 65 & LM2A >= 17 & LM2A <= 18 ~ 14,
        AGE >= 55 & AGE < 65 & LM2A >= 19 & LM2A <= 20 ~ 15,
        AGE >= 55 & AGE < 65 & LM2A == 21 ~ 16,
        AGE >= 55 & AGE < 65 & LM2A == 22 ~ 17,
        AGE >= 55 & AGE < 65 & LM2A == 23 ~ 18,
        AGE >= 55 & AGE < 65 & LM2A >= 24 & LM2A <= 25 ~ 19,
        
        # Age 65-69
        AGE >= 65 & AGE < 70 & LM2A == 0 ~ 2,
        AGE >= 65 & AGE < 70 & LM2A == 1 ~ 3,
        AGE >= 65 & AGE < 70 & LM2A == 2 ~ 4,
        AGE >= 65 & AGE < 70 & LM2A == 3 ~ 5,
        AGE >= 65 & AGE < 70 & LM2A >= 4 & LM2A <= 5 ~ 6,
        AGE >= 65 & AGE < 70 & LM2A == 6 ~ 7,
        AGE >= 65 & AGE < 70 & LM2A == 7 ~ 8,
        AGE >= 65 & AGE < 70 & LM2A >= 8 & LM2A <= 9 ~ 9,
        AGE >= 65 & AGE < 70 & LM2A >= 10 & LM2A <= 11 ~ 10,
        AGE >= 65 & AGE < 70 & LM2A == 12 ~ 11,
        AGE >= 65 & AGE < 70 & LM2A == 13 ~ 12,
        AGE >= 65 & AGE < 70 & LM2A >= 14 & LM2A <= 15 ~ 13,
        AGE >= 65 & AGE < 70 & LM2A >= 16 & LM2A <= 17 ~ 14,
        AGE >= 65 & AGE < 70 & LM2A >= 18 & LM2A <= 19 ~ 15,
        AGE >= 65 & AGE < 70 & LM2A == 20 ~ 16,
        AGE >= 65 & AGE < 70 & LM2A >= 21 & LM2A <= 22 ~ 17,
        AGE >= 65 & AGE < 70 & LM2A == 23 ~ 18,
        AGE >= 65 & AGE < 70 & LM2A >= 24 & LM2A <= 25 ~ 19,
        
        # Age 70-74
        AGE >= 70 & AGE < 75 & LM2A == 0 ~ 2,
        AGE >= 70 & AGE < 75 & LM2A == 1 ~ 4,
        AGE >= 70 & AGE < 75 & LM2A == 2 ~ 5,
        AGE >= 70 & AGE < 75 & LM2A >= 3 & LM2A <= 4 ~ 6,
        AGE >= 70 & AGE < 75 & LM2A == 5 ~ 7,
        AGE >= 70 & AGE < 75 & LM2A == 6 ~ 8,
        AGE >= 70 & AGE < 75 & LM2A >= 7 & LM2A <= 8 ~ 9,
        AGE >= 70 & AGE < 75 & LM2A >= 9 & LM2A <= 10 ~ 10,
        AGE >= 70 & AGE < 75 & LM2A == 11 ~ 11,
        AGE >= 70 & AGE < 75 & LM2A >= 12 & LM2A <= 13 ~ 12,
        AGE >= 70 & AGE < 75 & LM2A >= 14 & LM2A <= 15 ~ 13,
        AGE >= 70 & AGE < 75 & LM2A == 16 ~ 14,
        AGE >= 70 & AGE < 75 & LM2A >= 17 & LM2A <= 18 ~ 15,
        AGE >= 70 & AGE < 75 & LM2A == 19 ~ 16,
        AGE >= 70 & AGE < 75 & LM2A >= 20 & LM2A <= 21 ~ 17,
        AGE >= 70 & AGE < 75 & LM2A >= 22 & LM2A <= 23 ~ 18,
        AGE >= 70 & AGE < 75 & LM2A >= 24 & LM2A <= 25 ~ 19,
        
        # Age 75-79
        AGE >= 75 & AGE < 80 & LM2A == 0 ~ 3,
        AGE >= 75 & AGE < 80 & LM2A == 1 ~ 4,
        AGE >= 75 & AGE < 80 & LM2A == 2 ~ 5,
        AGE >= 75 & AGE < 80 & LM2A == 3 ~ 6,
        AGE >= 75 & AGE < 80 & LM2A == 4 ~ 7,
        AGE >= 75 & AGE < 80 & LM2A == 5 ~ 8,
        AGE >= 75 & AGE < 80 & LM2A >= 6 & LM2A <= 7 ~ 9,
        AGE >= 75 & AGE < 80 & LM2A >= 8 & LM2A <= 9 ~ 10,
        AGE >= 75 & AGE < 80 & LM2A == 10 ~ 11,
        AGE >= 75 & AGE < 80 & LM2A >= 11 & LM2A <= 12 ~ 12,
        AGE >= 75 & AGE < 80 & LM2A >= 13 & LM2A <= 14 ~ 13,
        AGE >= 75 & AGE < 80 & LM2A >= 15 & LM2A <= 16 ~ 14,
        AGE >= 75 & AGE < 80 & LM2A >= 17 & LM2A <= 18 ~ 15,
        AGE >= 75 & AGE < 80 & LM2A == 19 ~ 16,
        AGE >= 75 & AGE < 80 & LM2A >= 20 & LM2A <= 21 ~ 17,
        AGE >= 75 & AGE < 80 & LM2A == 22 ~ 18,
        AGE >= 75 & AGE < 80 & LM2A >= 23 & LM2A <= 25 ~ 19,
        
        # Age 80-84
        AGE >= 80 & AGE <= 84 & LM2A == 0 ~ 3,
        AGE >= 80 & AGE <= 84 & LM2A == 1 ~ 5,
        AGE >= 80 & AGE <= 84 & LM2A == 2 ~ 6,
        AGE >= 80 & AGE <= 84 & LM2A == 3 ~ 7,
        AGE >= 80 & AGE <= 84 & LM2A == 4 ~ 8,
        AGE >= 80 & AGE <= 84 & LM2A >= 5 & LM2A <= 6 ~ 9,
        AGE >= 80 & AGE <= 84 & LM2A >= 7 & LM2A <= 8 ~ 10,
        AGE >= 80 & AGE <= 84 & LM2A >= 9 & LM2A <= 10 ~ 11,
        AGE >= 80 & AGE <= 84 & LM2A >= 11 & LM2A <= 12 ~ 12,
        AGE >= 80 & AGE <= 84 & LM2A >= 13 & LM2A <= 14 ~ 13,
        AGE >= 80 & AGE <= 84 & LM2A == 15 ~ 14,
        AGE >= 80 & AGE <= 84 & LM2A >= 16 & LM2A <= 17 ~ 15,
        AGE >= 80 & AGE <= 84 & LM2A == 18 ~ 16,
        AGE >= 80 & AGE <= 84 & LM2A >= 19 & LM2A <= 20 ~ 17,
        AGE >= 80 & AGE <= 84 & LM2A >= 21 & LM2A <= 22 ~ 18,
        AGE >= 80 & AGE <= 84 & LM2A >= 23 & LM2A <= 25 ~ 19,
        
        # Age 85-89
        AGE >= 85 & AGE < 90 & LM2A == 0 ~ 2,
        AGE >= 85 & AGE < 90 & LM2A == 1 ~ 4,
        AGE >= 85 & AGE < 90 & LM2A == 2 ~ 5,
        AGE >= 85 & AGE < 90 & LM2A == 3 ~ 6,
        AGE >= 85 & AGE < 90 & LM2A == 4 ~ 7,
        AGE >= 85 & AGE < 90 & LM2A == 5 ~ 8,
        AGE >= 85 & AGE < 90 & LM2A >= 6 & LM2A <= 7 ~ 9,
        AGE >= 85 & AGE < 90 & LM2A == 8 ~ 10,
        AGE >= 85 & AGE < 90 & LM2A >= 9 & LM2A <= 10 ~ 11,
        AGE >= 85 & AGE < 90 & LM2A >= 11 & LM2A <= 12 ~ 12,
        AGE >= 85 & AGE < 90 & LM2A >= 13 & LM2A <= 14 ~ 13,
        AGE >= 85 & AGE < 90 & LM2A >= 15 & LM2A <= 16 ~ 14,
        AGE >= 85 & AGE < 90 & LM2A == 17 ~ 15,
        AGE >= 85 & AGE < 90 & LM2A >= 18 & LM2A <= 19 ~ 16,
        AGE >= 85 & AGE < 90 & LM2A == 20 ~ 17,
        AGE >= 85 & AGE < 90 & LM2A == 21 ~ 18,
        AGE >= 85 & AGE < 90 & LM2A >= 22 & LM2A <= 25 ~ 19,
        
        TRUE ~ as.numeric(LM2ASS)  # Keep existing value if no match
      ),
      
      # Story B Delayed Recall Scaled Score
      LM2BSS = case_when(
        # Check for missing values first
        is.na(LM2B) ~ NA_real_,
        
        # Age 45-54
        AGE >= 45 & AGE < 55 & LM2B == 0 ~ 1,
        AGE >= 45 & AGE < 55 & LM2B == 1 ~ 2,
        AGE >= 45 & AGE < 55 & LM2B == 2 ~ 3,
        AGE >= 45 & AGE < 55 & LM2B == 3 ~ 4,
        AGE >= 45 & AGE < 55 & LM2B == 4 ~ 5,
        AGE >= 45 & AGE < 55 & LM2B == 5 ~ 6,
        AGE >= 45 & AGE < 55 & LM2B == 6 ~ 7,
        AGE >= 45 & AGE < 55 & LM2B == 7 ~ 8,
        AGE >= 45 & AGE < 55 & LM2B >= 8 & LM2B <= 9 ~ 9,
        AGE >= 45 & AGE < 55 & LM2B == 10 ~ 10,
        AGE >= 45 & AGE < 55 & LM2B >= 11 & LM2B <= 12 ~ 11,
        AGE >= 45 & AGE < 55 & LM2B == 13 ~ 12,
        AGE >= 45 & AGE < 55 & LM2B == 14 ~ 13,
        AGE >= 45 & AGE < 55 & LM2B >= 15 & LM2B <= 16 ~ 14,
        AGE >= 45 & AGE < 55 & LM2B == 17 ~ 15,
        AGE >= 45 & AGE < 55 & LM2B == 18 ~ 16,
        AGE >= 45 & AGE < 55 & LM2B >= 19 & LM2B <= 20 ~ 17,
        AGE >= 45 & AGE < 55 & LM2B == 21 ~ 18,
        AGE >= 45 & AGE < 55 & LM2B >= 22 & LM2B <= 25 ~ 19,
        
        # Age 55-64
        AGE >= 55 & AGE < 65 & LM2B == 0 ~ 1,
        AGE >= 55 & AGE < 65 & LM2B == 1 ~ 2,
        AGE >= 55 & AGE < 65 & LM2B == 2 ~ 3,
        AGE >= 55 & AGE < 65 & LM2B == 3 ~ 4,
        AGE >= 55 & AGE < 65 & LM2B == 4 ~ 5,
        AGE >= 55 & AGE < 65 & LM2B == 5 ~ 6,
        AGE >= 55 & AGE < 65 & LM2B == 6 ~ 7,
        AGE >= 55 & AGE < 65 & LM2B == 7 ~ 8,
        AGE >= 55 & AGE < 65 & LM2B >= 8 & LM2B <= 9 ~ 9,
        AGE >= 55 & AGE < 65 & LM2B == 10 ~ 10,
        AGE >= 55 & AGE < 65 & LM2B == 11 ~ 11,
        AGE >= 55 & AGE < 65 & LM2B >= 12 & LM2B <= 13 ~ 12,
        AGE >= 55 & AGE < 65 & LM2B == 14 ~ 13,
        AGE >= 55 & AGE < 65 & LM2B >= 15 & LM2B <= 16 ~ 14,
        AGE >= 55 & AGE < 65 & LM2B == 17 ~ 15,
        AGE >= 55 & AGE < 65 & LM2B == 18 ~ 16,
        AGE >= 55 & AGE < 65 & LM2B >= 19 & LM2B <= 20 ~ 17,
        AGE >= 55 & AGE < 65 & LM2B == 21 ~ 18,
        AGE >= 55 & AGE < 65 & LM2B >= 22 & LM2B <= 25 ~ 19,
        
        # Age 65-69
        AGE >= 65 & AGE < 70 & LM2B == 0 ~ 1,
        AGE >= 65 & AGE < 70 & LM2B == 1 ~ 2,
        AGE >= 65 & AGE < 70 & LM2B == 2 ~ 3,
        AGE >= 65 & AGE < 70 & LM2B == 3 ~ 4,
        AGE >= 65 & AGE < 70 & LM2B == 4 ~ 5,
        AGE >= 65 & AGE < 70 & LM2B == 5 ~ 6,
        AGE >= 65 & AGE < 70 & LM2B == 6 ~ 7,
        AGE >= 65 & AGE < 70 & LM2B == 7 ~ 8,
        AGE >= 65 & AGE < 70 & LM2B >= 8 & LM2B <= 9 ~ 9,
        AGE >= 65 & AGE < 70 & LM2B == 10 ~ 10,
        AGE >= 65 & AGE < 70 & LM2B == 11 ~ 11,
        AGE >= 65 & AGE < 70 & LM2B >= 12 & LM2B <= 13 ~ 12,
        AGE >= 65 & AGE < 70 & LM2B == 14 ~ 13,
        AGE >= 65 & AGE < 70 & LM2B == 15 ~ 14,
        AGE >= 65 & AGE < 70 & LM2B == 16 ~ 15,
        AGE >= 65 & AGE < 70 & LM2B == 17 ~ 16,
        AGE >= 65 & AGE < 70 & LM2B >= 18 & LM2B <= 19 ~ 17,
        AGE >= 65 & AGE < 70 & LM2B == 20 ~ 18,
        AGE >= 65 & AGE < 70 & LM2B >= 21 & LM2B <= 25 ~ 19,
        
        # Age 70-74
        AGE >= 70 & AGE < 75 & LM2B == 0 ~ 2,
        AGE >= 70 & AGE < 75 & LM2B == 1 ~ 3,
        AGE >= 70 & AGE < 75 & LM2B == 2 ~ 4,
        AGE >= 70 & AGE < 75 & LM2B == 3 ~ 5,
        AGE >= 70 & AGE < 75 & LM2B == 4 ~ 6,
        AGE >= 70 & AGE < 75 & LM2B == 5 ~ 7,
        AGE >= 70 & AGE < 75 & LM2B == 6 ~ 8,
        AGE >= 70 & AGE < 75 & LM2B == 7 ~ 9,
        AGE >= 70 & AGE < 75 & LM2B == 8 ~ 10,
        AGE >= 70 & AGE < 75 & LM2B == 9 ~ 11,
        AGE >= 70 & AGE < 75 & LM2B == 10 ~ 12,
        AGE >= 70 & AGE < 75 & LM2B >= 11 & LM2B <= 12 ~ 13,
        AGE >= 70 & AGE < 75 & LM2B == 13 ~ 14,
        AGE >= 70 & AGE < 75 & LM2B == 14 ~ 15,
        AGE >= 70 & AGE < 75 & LM2B == 15 ~ 16,
        AGE >= 70 & AGE < 75 & LM2B >= 16 & LM2B <= 17 ~ 17,
        AGE >= 70 & AGE < 75 & LM2B == 18 ~ 18,
        AGE >= 70 & AGE < 75 & LM2B >= 19 & LM2B <= 25 ~ 19,
        
        # Age 75-79
        AGE >= 75 & AGE < 80 & LM2B == 0 ~ 3,
        AGE >= 75 & AGE < 80 & LM2B == 1 ~ 4,
        AGE >= 75 & AGE < 80 & LM2B == 2 ~ 5,
        AGE >= 75 & AGE < 80 & LM2B == 3 ~ 6,
        AGE >= 75 & AGE < 80 & LM2B == 4 ~ 7,
        AGE >= 75 & AGE < 80 & LM2B == 5 ~ 8,
        AGE >= 75 & AGE < 80 & LM2B == 6 ~ 9,
        AGE >= 75 & AGE < 80 & LM2B == 7 ~ 10,
        AGE >= 75 & AGE < 80 & LM2B >= 8 & LM2B <= 9 ~ 11,
        AGE >= 75 & AGE < 80 & LM2B == 10 ~ 12,
        AGE >= 75 & AGE < 80 & LM2B == 11 ~ 13,
        AGE >= 75 & AGE < 80 & LM2B == 12 ~ 14,
        AGE >= 75 & AGE < 80 & LM2B == 13 ~ 15,
        AGE >= 75 & AGE < 80 & LM2B == 14 ~ 16,
        AGE >= 75 & AGE < 80 & LM2B >= 15 & LM2B <= 16 ~ 17,
        AGE >= 75 & AGE < 80 & LM2B >= 17 & LM2B <= 18 ~ 18,
        AGE >= 75 & AGE < 80 & LM2B >= 19 & LM2B <= 25 ~ 19,
        
        # Age 80-84
        AGE >= 80 & AGE <= 84 & LM2B == 0 ~ 3,
        AGE >= 80 & AGE <= 84 & LM2B == 1 ~ 5,
        AGE >= 80 & AGE <= 84 & LM2B == 2 ~ 6,
        AGE >= 80 & AGE <= 84 & LM2B == 3 ~ 7,
        AGE >= 80 & AGE <= 84 & LM2B == 4 ~ 8,
        AGE >= 80 & AGE <= 84 & LM2B == 5 ~ 9,
        AGE >= 80 & AGE <= 84 & LM2B == 6 ~ 10,
        AGE >= 80 & AGE <= 84 & LM2B == 7 ~ 11,
        AGE >= 80 & AGE <= 84 & LM2B == 8 ~ 12,
        AGE >= 80 & AGE <= 84 & LM2B >= 9 & LM2B <= 10 ~ 13,
        AGE >= 80 & AGE <= 84 & LM2B == 11 ~ 14,
        AGE >= 80 & AGE <= 84 & LM2B >= 12 & LM2B <= 13 ~ 15,
        AGE >= 80 & AGE <= 84 & LM2B >= 14 & LM2B <= 15 ~ 16,
        AGE >= 80 & AGE <= 84 & LM2B >= 16 & LM2B <= 17 ~ 17,
        AGE >= 80 & AGE <= 84 & LM2B == 18 ~ 18,
        AGE >= 80 & AGE <= 84 & LM2B >= 19 & LM2B <= 25 ~ 19,
        
        # Age 85-89
        AGE >= 85 & AGE < 90 & LM2B == 0 ~ 3,
        AGE >= 85 & AGE < 90 & LM2B == 1 ~ 5,
        AGE >= 85 & AGE < 90 & LM2B == 2 ~ 6,
        AGE >= 85 & AGE < 90 & LM2B == 3 ~ 7,
        AGE >= 85 & AGE < 90 & LM2B == 4 ~ 8,
        AGE >= 85 & AGE < 90 & LM2B == 5 ~ 9,
        AGE >= 85 & AGE < 90 & LM2B == 6 ~ 10,
        AGE >= 85 & AGE < 90 & LM2B == 7 ~ 11,
        AGE >= 85 & AGE < 90 & LM2B == 8 ~ 12,
        AGE >= 85 & AGE < 90 & LM2B == 9 ~ 13,
        AGE >= 85 & AGE < 90 & LM2B >= 10 & LM2B <= 11 ~ 14,
        AGE >= 85 & AGE < 90 & LM2B >= 12 & LM2B <= 13 ~ 15,
        AGE >= 85 & AGE < 90 & LM2B >= 14 & LM2B <= 15 ~ 16,
        AGE >= 85 & AGE < 90 & LM2B == 16 ~ 17,
        AGE >= 85 & AGE < 90 & LM2B >= 17 & LM2B <= 18 ~ 18,
        AGE >= 85 & AGE < 90 & LM2B >= 19 & LM2B <= 25 ~ 19,
        
        TRUE ~ as.numeric(LM2BSS)  # Keep existing value if no match
      )
    )
  
  return(df)
}
